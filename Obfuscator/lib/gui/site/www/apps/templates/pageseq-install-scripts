<% use obfui::cmn;     my ($cfgref,$rlist_of_tools,$perlpath) = @_;

    my($width_dir,$width_perl,$width_btn) = ($cfgref->{product}->{lang} eq 'perl') ? qw(six five five) : 
	qw(ten x six);

 %>

<% $forge->include('wgt-load-semanticui') %>
<% $forge->include('wgt-init-filesysbrowser',$cfgref) %>

<style type=text/css>
div.warning b{ color: black; }
Xdiv.warning a.menuref { color: black; }
</style>



<div class="main ui container">
<div class="ui segment">
    <% $forge->include('wgt-semui-header',  __('Installing command line versions of the tools') ) %>

     <form class="ui  form">
	<input type=hidden name=havevals value=1>
        <div class="fields">


	    <div class="<%= $width_dir %> wide field required">
		<label><%= __("Select directory to install command line tools to:") %>
		</label>

		<div class="ui action input">
		    <input required name="dir"  id=indir 
<% my $dirval = $^O =~ /Win/ ? 'c:\\opt\\bin' :  "$ENV{HOME}/bin" ; %>
			placeholder="<%= $dirval  %>" value="<%= $dirval %>" type="text">
		    <button class="ui icon button" id="indir_btn" dataset-id="dir">
			<i class="folder icon"></i>
		      </button>
		</div>
	    </div>

<% if ($cfgref->{product}->{lang} eq 'perl') { %>

	    <div class="<%= $width_perl %> wide field required">
		<label><%= __("Path to Perl executable to use:") %></label>
		<div class="ui input">
		    <input required name="perlpath"  value="<%= $perlpath%>" id=perlpath type=text>
		</div>
	    </div>


<% } else { %>
	    <input type=hidden name=perlpath value="<%= $perlpath%>">
<% } %>

	    <div class="<%= $width_btn %> wide field">
		<label>&nbsp;</label>
        	<button class="ui fluid primary wide button"><i class="ui icon setting"></i>
		 <%=  __('Install tools') %>  </button>
	    </div>
    	</div>
    </form>
    </div>




<% $forge->include('wgt-optional-start','purpose',__('What is this for?')) %>
    <%$ sprintf(__('Command line versions of the obfuscator (%s) and other useful scripts that come with it can be difficult to find inside directory where %s is installed, and it\'s incovenient to refer to them using full paths.<p>You can install the "aliases" to all these scripts and command line tools into certain directory and then invoke them from that directory. If you install aliases into directory listed in your PATH environment variable, then you will not need to specify any directory part at all when invoking those scripts and command line tools!'),
	$cfgref->{product}{exename},$cfgref->{product}{title}) %>
    <p>
<% $forge->include('wgt-optional-start','path', __('What directories are currently listed in the PATH?')) %>   
<% 
    my $sep =     $^O =~ /Win32/i ? ';' : ':';
    my %h; map { $h{$_} = 1 } split($sep, $ENV{PATH});
    foreach (sort { $a cmp $b } keys %h) {
	print "$_<br>";
    }
%>
<% $forge->include('wgt-optional-end','path') %>

<% $forge->include('wgt-optional-end','purpose') %>

<p>

<% $forge->include('wgt-optional-start','list_of_tools',__('What will be installed')) %>
<%= __("Proxies for the following tools will be installed:") %>
<ul>
<% foreach my $i (@$rlist_of_tools) { %>

    <li>
    <% if ($i->{has_doc} ) { %>
	<a target=_doc href=<%= $i->{docurl} %> >   <%= $i->{destfilename} %>  </a>
    <% } else  { %>
        <%= $i->{destfilename} %> 
    <% } %>


<% } %>
</ul>

<% $forge->include('wgt-optional-end','list_of_tools') %>
<p>



    <div class="ui visible warning message">
        <div class="header"><%= __('Warning!') %></div>
<%$ sprintf( __('Please note: it is <b>greatly adviced to use this GUI</b> (Project Manager) that you are currently using for all operations, <b>instead of calling command line backends directly</b>!')) %>

<%$ sprintf( __('If you need to perform protection of your project from command line, just create a %s for your project using <span class=menuref>Project &rArr; Generate buildscript</span> or <span class=menuref>Project &rArr; Generate buildscript as .bat</span>, and then call the generated script with desired command line arguments to build/rebuild/clean the project or some subset of it.'),
    '<a class=menuref target=_doc href=/support/doc/obfusui/buildscript.shtml>buildscript</a>')   %>
	
    </div>
</div>

<% $forge->include('wgt-page-prjoptions-pickdirjs',  'disallowspaces',0) %>

