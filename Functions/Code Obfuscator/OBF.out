#include <stdio.h>
#include <string.h>
#include <algorithm>
#include <tuple>
#define PuHCWimRPp(cwaZJCInQvdNn,pFVxfPyZDWFJBR,dUnIXnRvhsaEhvMA) for (int cwaZJCInQvdNn = (pFVxfPyZDWFJBR); (cwaZJCInQvdNn) <= (dUnIXnRvhsaEhvMA); ++(cwaZJCInQvdNn))
constexpr int ubMRswMUZGnQ = 1000005, ZMCRlfsfwFkdsuFW = 1e9;
int GNFwonoKZ[ubMRswMUZGnQ];
namespace EgQSwEBuaCfrd {
    char tUpWkTvxEF[1 << 21], *VawTKYPgRdhwnva(nullptr), *guSMfdAORtt(nullptr);
    inline char get() {
        if (VawTKYPgRdhwnva == guSMfdAORtt) guSMfdAORtt = (VawTKYPgRdhwnva=tUpWkTvxEF) + fread(tUpWkTvxEF, 1, sizeof tUpWkTvxEF, stdin);
        return *VawTKYPgRdhwnva++;
    }
    inline void CkCtMDenEcTrAUcO(int &XpQDeaAYSRGlmCZK) {
        char aAGAVIfhZ = get();
        while (aAGAVIfhZ < (char)(48) || aAGAVIfhZ > (char)(57)) aAGAVIfhZ = get();
        for (XpQDeaAYSRGlmCZK = aAGAVIfhZ ^ (char)(48), aAGAVIfhZ = get(); aAGAVIfhZ >= (char)(48) && aAGAVIfhZ <= (char)(57); aAGAVIfhZ = get())
            XpQDeaAYSRGlmCZK = (XpQDeaAYSRGlmCZK << 3) + (XpQDeaAYSRGlmCZK << 1) + (aAGAVIfhZ ^ (char)(48));
    }
} using EgQSwEBuaCfrd::CkCtMDenEcTrAUcO;
int XGaaEsqVpQkWYi, GvoYUMzrfjmp, kzmvaoBLNC;
inline int ZKOsAkkUzKULFNsh() {
    int QrOpDqQBpvVh = std::lower_bound(GNFwonoKZ+1, GNFwonoKZ+1 + XGaaEsqVpQkWYi, kzmvaoBLNC) - GNFwonoKZ,
        uMyEsAhrKFG = std::upper_bound(GNFwonoKZ+1, GNFwonoKZ+1 + XGaaEsqVpQkWYi, kzmvaoBLNC + GvoYUMzrfjmp) - GNFwonoKZ-1;
    int ieKBjimCTDKT = QrOpDqQBpvVh; // 当前最左边到的
    int gGwBwwbNn = 1;   // 最左边未取的
    int mDwIGjwqkBZPe = kzmvaoBLNC; // 最左边在 [mDwIGjwqkBZPe, mDwIGjwqkBZPe + GvoYUMzrfjmp]
    int suzYQiZxzbbD = 0;
    while (ieKBjimCTDKT >= gGwBwwbNn) {
        int OOswQNCm = uMyEsAhrKFG, cbgAAwmb = XGaaEsqVpQkWYi, XskujFAFWaG;
        while (OOswQNCm <= cbgAAwmb) {
            XskujFAFWaG = OOswQNCm + cbgAAwmb >> 1;
            //  所需要的最少右移次数     可以提供的最大右移次数
            if (GNFwonoKZ[XskujFAFWaG] - (kzmvaoBLNC + GvoYUMzrfjmp) <= XGaaEsqVpQkWYi - XskujFAFWaG - (QrOpDqQBpvVh - ieKBjimCTDKT)) OOswQNCm = XskujFAFWaG + 1;
            else cbgAAwmb = XskujFAFWaG - 1;
        }
        suzYQiZxzbbD = std::max(suzYQiZxzbbD, cbgAAwmb - ieKBjimCTDKT + 1);
        --ieKBjimCTDKT;
        gGwBwwbNn += mDwIGjwqkBZPe - GNFwonoKZ[ieKBjimCTDKT], mDwIGjwqkBZPe = GNFwonoKZ[ieKBjimCTDKT];
    }
    return suzYQiZxzbbD;
}
inline void dwYlSwvpbylxVq() {
    CkCtMDenEcTrAUcO(XGaaEsqVpQkWYi), CkCtMDenEcTrAUcO(GvoYUMzrfjmp), CkCtMDenEcTrAUcO(kzmvaoBLNC);
    PuHCWimRPp (cwaZJCInQvdNn, 1, XGaaEsqVpQkWYi) CkCtMDenEcTrAUcO(GNFwonoKZ[cwaZJCInQvdNn]);
    std::sort(GNFwonoKZ+1, GNFwonoKZ+1 + XGaaEsqVpQkWYi);
    int NdPwUkTmYujeUL = ZKOsAkkUzKULFNsh();
    PuHCWimRPp (cwaZJCInQvdNn, 1, XGaaEsqVpQkWYi) GNFwonoKZ[cwaZJCInQvdNn] = ZMCRlfsfwFkdsuFW - GNFwonoKZ[cwaZJCInQvdNn];
    kzmvaoBLNC = ZMCRlfsfwFkdsuFW - kzmvaoBLNC - GvoYUMzrfjmp;
    std::reverse(GNFwonoKZ+1, GNFwonoKZ+1 + XGaaEsqVpQkWYi);
    int XxnEEbRvUukli = ZKOsAkkUzKULFNsh();
    printf("\u0025\u0064\u000A", std::max(NdPwUkTmYujeUL, XxnEEbRvUukli));
}
int main() {
    freopen("\u0069\u0071\u002E\u0069\u006E", "\u0072", stdin);
    freopen("\u0069\u0071\u002E\u006F\u0075\u0074", "\u0077", stdout);
    int GnqcxMUkN;
    CkCtMDenEcTrAUcO(GnqcxMUkN);
    while (GnqcxMUkN--) dwYlSwvpbylxVq();
    return 0;
}
