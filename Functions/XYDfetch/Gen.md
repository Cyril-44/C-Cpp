# 📘 题目：饭语

## 🧾 题目描述
由于原本的题面太过繁琐，这里给出形式化题意。

给定一张有向无环图（DAG）$G = (V, E)$，其中包含恰好 $n$ 个顶点和 $m$ 条边。保证对于每个顶点 $i$（$1 \leq i \leq n$），它都是从顶点 $1$ **可达**的。

在图 $G$ 中，如果从顶点 $u$ 出发存在一条路径到达顶点 $v$，则称顶点 $u$ **可达**顶点 $v$。

对于一个非空顶点集合 $A \subseteq V$，如果 $A$ 中的**每一个**顶点都**可达**顶点 $w$，则称 $w$ 对于集合 $A$ 是**良好**的。记 $f(A)$ 为对集合 $A$ 来说所有**良好**顶点组成的集合。

特别地，$f(\empty) = \empty$。

给定两个长度为 $n$ 的数组 $p_i,q_i$，请你求出下面式子的值对 $998244353$ 取模后的结果。 


$$\sum_{A \subseteq V} (\prod_{u \in A} p_u) \times \frac{\sum_{u \in f(A)} q_u}{(\oplus_{u \in f(A)} q_u)+1}$$


其中 $\oplus$ 代表按位异或。定义当 $A = \empty$ 时，$\prod_{u \in A} p_u=1,\sum_{u \in A} q_u=0,\oplus_{u \in A} q_u=0$。

**保证 $m-n$ 是一个小常数。**

## 📥 输入格式
第一行两个数 $n,m$。

接下来 $m$ 行每行两个数 $u,v$ 代表一条图上 $u$ 到 $v$ 的有向边。

再接下来一行 $n$ 个数代表 $p_i$。

再接下来一行 $n$ 个数代表 $q_i$。

## 📤 输出格式
输出一行一个数表示答案。

## 📌 约束条件
## 

|  测试点编号  |     $n$     |      特殊性质       |
| :----------: | :---------: | :-----------------: |
|  $1 \sim 2$  |  $\leq 5$   |         无          |
|  $3 \sim 5$  | $\leq 10^6$ |       $m=n-1$       |
| $6 \sim 10$  | $\leq 10^6$ |    $m-n \leq 5$     |
| $11 \sim 14$ | $\leq 10^6$ | 所有 $p_i$ 均为 $1$ |
| $15 \sim 18$ | $\leq 300$  |         无          |
| $19 \sim 25$ | $\leq 10^6$ |         无          |


对于全部数据，保证 $1 \leq n \leq 10^6,-1 \leq m-n \leq 20,0 \leq p_i,q_i \leq 10^6$。

## 🧪 样例
### 样例 1
**输入：**
```
5 6
1 2
1 3
2 5
2 4
3 5
3 4
1 1 1 1 1
2 4 3 1 4
```
**输出：**
```
579932471
```

### 样例 2
**输入：**
```
10 16
1 2
1 3
1 4
2 5
2 6
6 7
3 8
8 9
4 10
3 6
3 10
2 8
2 10
4 8
4 5
4 6
1 1 1 1 1 1 1 1 1 1
2 4 3 1 5 4 7 8 2 3
```
**输出：**
```
732802266
```


