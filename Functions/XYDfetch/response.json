{"code":200,"data":{"id":42576,"type":7,"statementZh":"由于原本的题面太过繁琐，这里给出形式化题意。\n\n给定一张有向无环图（DAG）$G = (V, E)$，其中包含恰好 $n$ 个顶点和 $m$ 条边。保证对于每个顶点 $i$（$1 \\leq i \\leq n$），它都是从顶点 $1$ **可达**的。\n\n在图 $G$ 中，如果从顶点 $u$ 出发存在一条路径到达顶点 $v$，则称顶点 $u$ **可达**顶点 $v$。\n\n对于一个非空顶点集合 $A \\subseteq V$，如果 $A$ 中的**每一个**顶点都**可达**顶点 $w$，则称 $w$ 对于集合 $A$ 是**良好**的。记 $f(A)$ 为对集合 $A$ 来说所有**良好**顶点组成的集合。\n\n特别地，$f(\\empty) = \\empty$。\n\n给定两个长度为 $n$ 的数组 $p_i,q_i$，请你求出下面式子的值对 $998244353$ 取模后的结果。 \n\n\n$$\\sum_{A \\subseteq V} (\\prod_{u \\in A} p_u) \\times \\frac{\\sum_{u \\in f(A)} q_u}{(\\oplus_{u \\in f(A)} q_u)+1}$$\n\n\n其中 $\\oplus$ 代表按位异或。定义当 $A = \\empty$ 时，$\\prod_{u \\in A} p_u=1,\\sum_{u \\in A} q_u=0,\\oplus_{u \\in A} q_u=0$。\n\n**保证 $m-n$ 是一个小常数。**","statementEn":"","tags":null,"correctRate":0,"totalScore":100,"blankNumber":0,"userAnswer":[],"userLastAnswer":[],"url":"","expireTime":0,"content":"","videoId":"","playAuth":"","sourceType":0,"programId":23187,"origin":"xjoi","titleZh":"饭语","titleEn":"language","inputFormatZh":"第一行两个数 $n,m$。\n\n接下来 $m$ 行每行两个数 $u,v$ 代表一条图上 $u$ 到 $v$ 的有向边。\n\n再接下来一行 $n$ 个数代表 $p_i$。\n\n再接下来一行 $n$ 个数代表 $q_i$。","outputFormatZh":"输出一行一个数表示答案。","constraintZh":"## \n\n|  测试点编号  |     $n$     |      特殊性质       |\n| :----------: | :---------: | :-----------------: |\n|  $1 \\sim 2$  |  $\\leq 5$   |         无          |\n|  $3 \\sim 5$  | $\\leq 10^6$ |       $m=n-1$       |\n| $6 \\sim 10$  | $\\leq 10^6$ |    $m-n \\leq 5$     |\n| $11 \\sim 14$ | $\\leq 10^6$ | 所有 $p_i$ 均为 $1$ |\n| $15 \\sim 18$ | $\\leq 300$  |         无          |\n| $19 \\sim 25$ | $\\leq 10^6$ |         无          |\n\n\n对于全部数据，保证 $1 \\leq n \\leq 10^6,-1 \\leq m-n \\leq 20,0 \\leq p_i,q_i \\leq 10^6$。","timeLimit":"3000ms","memoryLimit":"524288kB","fileIO":"language.in/language.out","backgroundZh":"饭语几大精髓\n\n1. 要有歧义\n2. 要指代不明\n3. 要有错字","hustOJProblemId":0,"outCases":["uoj1.ans","uoj2.ans","uoj3.ans","uoj4.ans","uoj5.ans","uoj6.ans","uoj7.ans","uoj8.ans","uoj9.ans","uoj10.ans","uoj11.ans","uoj12.ans","uoj13.ans","uoj14.ans","uoj15.ans","uoj16.ans","uoj17.ans","uoj18.ans","uoj19.ans","uoj20.ans","uoj21.ans","uoj22.ans","uoj23.ans","uoj24.ans","uoj25.ans"],"annexs":[{"url":"https://oss.aws.turingstar.com.cn/fc220c88-2361-465f-af13-4cd7edf70ee4","uuid":"fc220c88-2361-465f-af13-4cd7edf70ee4","fileName":"ex_language.zip"}],"examples":[{"input":"5 6\n1 2\n1 3\n2 5\n2 4\n3 5\n3 4\n1 1 1 1 1\n2 4 3 1 4","output":"579932471"},{"input":"10 16\n1 2\n1 3\n1 4\n2 5\n2 6\n6 7\n3 8\n8 9\n4 10\n3 6\n3 10\n2 8\n2 10\n4 8\n4 5\n4 6\n1 1 1 1 1 1 1 1 1 1\n2 4 3 1 5 4 7 8 2 3","output":"732802266"}]},"msg":"Success"}